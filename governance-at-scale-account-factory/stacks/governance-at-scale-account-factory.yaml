# Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0

Schema: factory-2019-04-01
Stacks:
    - Name: account-creation-notifier-cfh-handler
      Source:
        Configuration:
          RepositoryName: account-creation-notifier-cfh-handler
        Provider: CodeCommit
      Tags: []
      Versions:
        - Name: v1
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v1
              RepositoryName: account-creation-notifier-cfh-handler
    - Name: account-creation-shared-org-bootstrap
      Source:
        Configuration:
          RepositoryName: account-creation-shared-org-bootstrap
        Provider: CodeCommit
      Tags: []
      Versions:
        - Name: v1
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v1
              RepositoryName: account-creation-shared-org-bootstrap
    - Name: account-type-to-organizational-unit-chooser
      Source:
        Configuration:
          RepositoryName: account-type-to-organizational-unit-chooser
        Provider: CodeCommit
      Tags: []
      Versions:
        - Name: v1
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v1
              RepositoryName: account-type-to-organizational-unit-chooser
    - Name: account-bootstrap-shared
      Source:
        Configuration:
          RepositoryName: account-bootstrap-shared
        Provider: CodeCommit
      BuildSpec: |
        version: 0.2
        phases:
          install:
            runtime-versions:
              python: 3.x
          build:
            commands:
              - pip install -r requirements.txt -t src
            {% for region in ALL_REGIONS %}
              - aws cloudformation package --template $(pwd)/product.template.yaml --s3-bucket sc-factory-artifacts-${ACCOUNT_ID}-{{ region }} --s3-prefix ${STACK_NAME} --output-template-file product.template-{{ region }}.yaml
            {% endfor %}
        artifacts:
          files:
            - '*'
            - '**/*'
      Tags: []
      Versions:
        - Name: v2
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v2
              RepositoryName: account-bootstrap-shared
    - Name: account-creation-shared
      Source:
        Configuration:
          RepositoryName: account-creation-shared
        Provider: CodeCommit
      BuildSpec: |
        version: 0.2
        phases:
          install:
            runtime-versions:
              python: 3.x
          build:
            commands:
              - pip install -r requirements.txt -t src
            {% for region in ALL_REGIONS %}
              - aws cloudformation package --template $(pwd)/product.template.yaml --s3-bucket sc-factory-artifacts-${ACCOUNT_ID}-{{ region }} --s3-prefix ${STACK_NAME} --output-template-file product.template-{{ region }}.yaml
            {% endfor %}
        artifacts:
          files:
            - '*'
            - '**/*'
      Tags: []
      Versions:
        - Name: v4
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v4
              RepositoryName: account-creation-shared
    - Name: account-create-update-notifier
      Source:
        Configuration:
          RepositoryName: account-create-update-notifier
        Provider: CodeCommit
      Versions:
        - Name: v1
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v1
              RepositoryName: account-create-update-notifier
    - Name: account-bootstrap-shared-org-bootstrap
      Source:
        Configuration:
          RepositoryName: account-bootstrap-shared-org-bootstrap
        Provider: CodeCommit
      Tags: []
      Versions:
        - Name: v1
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v1
              RepositoryName: account-bootstrap-shared-org-bootstrap
    - Name: account-details
      Source:
        Configuration:
          RepositoryName: account-details
        Provider: CodeCommit
      Tags: []
      Versions:
        - Name: v1
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v1
              RepositoryName: account-details
    - Name: account-details-org-bootstrap
      Source:
        Configuration:
          RepositoryName: account-details-org-bootstrap
        Provider: CodeCommit
      Versions:
        - Name: v1
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v1
              RepositoryName: account-details-org-bootstrap

    - Name: account-waiter
      Source:
        Configuration:
          RepositoryName: account-waiter
        Provider: CodeCommit
      Versions:
        - Name: v3
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v3
              RepositoryName: account-waiter
      Tags:
        - Key: team
          Value: ccoe

    - Name: move-to-ou
      Source:
        Configuration:
          RepositoryName: move-to-ou
        Provider: CodeCommit
      Versions:
        - Name: v2
          Source:
            Provider: CodeCommit
            Configuration:
              BranchName: v2
              RepositoryName: move-to-ou
      Tags:
        - Key: team
          Value: ccoe
